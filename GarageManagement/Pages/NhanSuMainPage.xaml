<?xml version="1.0" encoding="utf-8"?>
<ContentView
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    x:Class="GarageManagement.Pages.NhanSuMainPage"
    xmlns:service="clr-namespace:GarageManagement.Services"
    x:Name="RootContentView"
 
    BackgroundColor="{DynamicResource BackgroundColor}">

    <!-- Gradient ná»n -->
    <ContentView.Background>
        <LinearGradientBrush x:Name="AnimatedBrush" StartPoint="-0.5,-0.5"
                       EndPoint="1.5,1.5"/>
    </ContentView.Background>

    <!-- Cuá»™n náº¿u ná»™i dung vÆ°á»£t khung -->
    <ScrollView MaximumWidthRequest="1000">
        <VerticalStackLayout Spacing="20" Padding="20">

            <Grid Grid.Row="0" ColumnDefinitions="*,Auto">
                <!-- Lá»i chÃ o -->
                <Label Text="{Binding TenNguoiDung, StringFormat='Xin chÃ o, {0}!'}"
                    TextColor="{DynamicResource TextColor}"
                    FontSize="20"
                    FontAttributes="Bold"
                    VerticalOptions="Center">
                    
                </Label>

                <!-- Khung ngÃ y / giá» -->
                <Frame Grid.Column="1"
                    Padding="10"
                    CornerRadius="12"
                    BackgroundColor="{DynamicResource CardBackgroundColor}"
                    HasShadow="True"
                    VerticalOptions="Center"
                    HorizontalOptions="End">
                    <Grid ColumnDefinitions="Auto,Auto,*">
                        <!-- NgÃ y & Thá»© -->
                        <StackLayout Grid.Column="0"
                       Orientation="Vertical"
                       Spacing="0">
                            <Label x:Name="DateLabel"
                               FontSize="12"
                               TextColor="{DynamicResource TextColor}"
                               FontAttributes="Bold"
                               HorizontalOptions="Center" />
                            <Label x:Name="DayLabel"
                               FontSize="12"
                               TextColor="{DynamicResource TextColor}"
                               HorizontalOptions="Center" />
                        </StackLayout>

                        <!-- Separator nhá» -->
                        <BoxView Grid.Column="1"
                           WidthRequest="1"
                           Color="{DynamicResource TextColor}"
                           Opacity="0.2"
                           Margin="10,0" />

                        <!-- Äá»“ng há»“ -->
                        <Label Grid.Column="2"
                         x:Name="ClockLabel"
                         FontSize="22"
                         FontAttributes="Bold"
                         TextColor="{DynamicResource TextColor}"
                         HorizontalOptions="Center"
                         VerticalOptions="Center" />
                    </Grid>
                </Frame>
            </Grid>

            <!-- Gáº¡ch ngÄƒn -->
            <BoxView
                HeightRequest="1"
                Color="{DynamicResource TextColor}"
                Opacity="0.2"
                HorizontalOptions="Fill" />

            <!-- ========== CARD THÃ”NG TIN ========== -->
            <Frame
              Grid.Row="2"
              Padding="20"
              CornerRadius="20"
              BackgroundColor="{DynamicResource CardBackgroundColor}"
              HasShadow="True"
              VerticalOptions="Start">
                <VerticalStackLayout Spacing="20">

                    <!-- Avatar vá»›i ellipse ná»n -->
                    <Grid HorizontalOptions="Center">
                        <Frame
                            WidthRequest="140"
                            HeightRequest="140"
                            CornerRadius="70"
                            BackgroundColor="{DynamicResource AccentColor}"
                            Opacity="0.2"
                            HasShadow="False" />
                        <Frame
                            WidthRequest="120"
                            HeightRequest="120"
                            CornerRadius="60"
                            IsClippedToBounds="True"
                            BorderColor="{DynamicResource AccentColor}"
                            HasShadow="True">
                            <Image Source="{Binding AvatarUrl}" Aspect="AspectFill" />
                        </Frame>
                    </Grid>

                    <!-- ThÃ´ng tin cÃ¡ nhÃ¢n -->
                    <VerticalStackLayout Spacing="12">

                        <!-- DÃ²ng 1 -->
                        <HorizontalStackLayout Spacing="8">
                            <Label Text="ðŸ‘¤" FontSize="18" />
                            <Label Text="TÃ i khoáº£n:" FontAttributes="Bold" TextColor="{DynamicResource TextColor}" />
                            <Label Text="{Binding TenTaiKhoan}" TextColor="{DynamicResource TextColor}" HorizontalOptions="StartAndExpand" />
                        </HorizontalStackLayout>

                        <!-- DÃ²ng 2 -->
                        <HorizontalStackLayout Spacing="8">
                            <Label Text="ðŸ“" FontSize="18" />
                            <Label Text="Há» vÃ  tÃªn:" FontAttributes="Bold" TextColor="{DynamicResource TextColor}" />
                            <Label Text="{Binding HoVaTen}" TextColor="{DynamicResource TextColor}" HorizontalOptions="StartAndExpand" />
                        </HorizontalStackLayout>

                        <!-- DÃ²ng 3 -->
                        <HorizontalStackLayout Spacing="8">
                            <Label Text="ðŸŽ‚" FontSize="18" />
                            <Label Text="Tuá»•i:" FontAttributes="Bold" TextColor="{DynamicResource TextColor}" />
                            <Label Text="{Binding Tuoi}" TextColor="{DynamicResource TextColor}" HorizontalOptions="StartAndExpand" />
                        </HorizontalStackLayout>

                        <!-- DÃ²ng 4 -->
                        <HorizontalStackLayout Spacing="8">
                            <Label Text="ðŸ " FontSize="18" />
                            <Label Text="Äá»‹a chá»‰:" FontAttributes="Bold" TextColor="{DynamicResource TextColor}" />
                            <Label Text="{Binding DiaChi}" TextColor="{DynamicResource TextColor}" HorizontalOptions="StartAndExpand" />
                        </HorizontalStackLayout>

                        <!-- DÃ²ng 5 -->
                        <HorizontalStackLayout Spacing="8">
                            <Label Text="ðŸ“ž" FontSize="18" />
                            <Label Text="SÄT:" FontAttributes="Bold" TextColor="{DynamicResource TextColor}" />
                            <Label Text="{Binding SoDienThoai}" TextColor="{DynamicResource TextColor}" HorizontalOptions="StartAndExpand" />
                        </HorizontalStackLayout>

                        <!-- DÃ²ng 6 -->
                        <HorizontalStackLayout Spacing="8">
                            <Label Text="âœ‰ï¸" FontSize="18" />
                            <Label Text="Email:" FontAttributes="Bold" TextColor="{DynamicResource TextColor}" />
                            <Label Text="{Binding Email}" TextColor="{DynamicResource TextColor}" HorizontalOptions="StartAndExpand" />
                        </HorizontalStackLayout>

                    </VerticalStackLayout>

                </VerticalStackLayout>
            </Frame>

            <Frame 
    Padding="10"
    CornerRadius="12"
    BackgroundColor="{DynamicResource CardBackgroundColor}"
    HasShadow="True"
    VerticalOptions="Center">
                <VerticalStackLayout>
                    <!-- ========== DANH SÃCH THÃ”NG BÃO ========== -->
                    <Label Text="ThÃ´ng bÃ¡o má»›i"
FontSize="18"
FontAttributes="Bold"
TextColor="{DynamicResource TextColor}"
Margin="0,10,0,0" />

                    <Grid ColumnDefinitions="Auto,*,Auto"
 VerticalOptions="Center"
 Padding="5">

                        <!-- NÃºt mÅ©i tÃªn trÃ¡i -->
                        <Button Text="â—€"
     Command="{Binding ScrollToLeftCommand}"
     FontSize="20"
     WidthRequest="40"
     HeightRequest="40"
     BackgroundColor="Transparent"
     TextColor="{DynamicResource TextColor}" />

                        <!-- Danh sÃ¡ch ngang -->
                        <ScrollView Orientation="Horizontal"
     x:Name="ThongBaoScrollView"
     Grid.Column="1"
     HorizontalScrollBarVisibility="Never">
                            <HorizontalStackLayout x:Name="ThongBaoListLayout" Spacing="10">
                                <!-- DataTemplate cho tá»«ng thÃ´ng bÃ¡o -->
                                <CollectionView ItemsSource="{Binding DanhSachThongBao}"
             SelectionMode="None">

                                    <CollectionView.ItemsLayout>
                                        <LinearItemsLayout ItemSpacing="10" Orientation="Horizontal"/>
                                    </CollectionView.ItemsLayout>

                                    <CollectionView.ItemTemplate>
                                        <DataTemplate>
                                            <Frame Padding="10"
                        CornerRadius="12"
                        HeightRequest="140"               
                        BackgroundColor="{Binding DaDoc, Converter={StaticResource ThongBaoColorConverter}}"
                         HasShadow="True">

                                                <Grid RowDefinitions="Auto,*,Auto"   
                             VerticalOptions="Fill">
                                                    <!-- Rá»™ng theo ná»™i dung -->

                                                    <!-- Ná»™i dung thÃ´ng bÃ¡o -->
                                                    <Label Grid.Row="0"
                                Text="{Binding Content}"
                                FontSize="14"
                                LineBreakMode="WordWrap"
                                TextColor="White"
                                HorizontalOptions="Fill"
                                VerticalOptions="Start" />

                                                    <!-- Khoáº£ng Ä‘á»‡m Ä‘á»ƒ Ä‘áº©y pháº§n chÃ¢n xuá»‘ng dÆ°á»›i -->
                                                    <BoxView Grid.Row="1"
                                 VerticalOptions="Fill"
                                 BackgroundColor="Transparent" />

                                            <!-- CheckBox + thá»i gian -->
                                            <Grid Grid.Row="2" ColumnDefinitions="*,Auto" Padding="0,5,0,0">
                                                <!-- Cá»™t trÃ¡i: CheckBox vÃ  nhÃ£n -->
                                                <VerticalStackLayout Spacing="2" Grid.Column="0">
                                                    <Label Text="ÄÃ¡nh dáº¥u lÃ  Ä‘Ã£ Ä‘á»c"
                                                       FontSize="12"
                                                       IsVisible="{Binding Visible}"
                                                       TextColor="White"
                                                       HorizontalOptions="Start"/>
                                                    <CheckBox IsChecked="{Binding DaDoc, Mode=TwoWay}" 
                                                      Color="White"
                                                      IsVisible="{Binding Visible}"
                                                      CheckedChanged="OnThongBaoCheckedChanged" />
                                                </VerticalStackLayout>

                                                <!-- Cá»™t pháº£i: Thá»i gian náº±m sÃ¡t bÃªn pháº£i -->
                                                <Label Grid.Column="1"
                                                   Text="{Binding taoVaoLuc, StringFormat='{0:dd/MM/yyyy HH:mm}'}"
                                                   FontSize="12"
                                                   TextColor="Black"
                                                   VerticalOptions="End"
                                                   HorizontalOptions="End"
                                                   Margin="10,0,0,0"/>
                                            </Grid>

                                        </Grid>
                                    </Frame>
                                </DataTemplate>
                            </CollectionView.ItemTemplate>

                                </CollectionView>
                            </HorizontalStackLayout>
                        </ScrollView>

                        <!-- NÃºt mÅ©i tÃªn pháº£i -->
                        <Button Text="â–¶"
     Command="{Binding ScrollToRightCommand}"
     FontSize="20"
     WidthRequest="40"
     HeightRequest="40"
     BackgroundColor="Transparent"
     TextColor="{DynamicResource TextColor}"
     Grid.Column="2" />
                    </Grid>
                </VerticalStackLayout>
            </Frame>

        </VerticalStackLayout>
    </ScrollView>
</ContentView>
